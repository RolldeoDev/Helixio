# Helixio Redis Configuration
# Optimized for embedded cache use alongside PostgreSQL

# =============================================================================
# Memory Management
# =============================================================================

# Maximum memory limit (1GB for cache layer - covers + data caching)
maxmemory 1gb

# Eviction policy: Remove least recently used keys when memory is full
# This is ideal for cache usage where older data is less valuable
maxmemory-policy allkeys-lru

# Sample 10 keys when looking for LRU candidates (higher = more accurate, slower)
maxmemory-samples 10

# =============================================================================
# Persistence (Disabled for cache-only usage)
# =============================================================================

# Disable RDB snapshots (we don't need persistence for cache)
save ""

# Disable AOF (Append Only File) persistence
appendonly no

# =============================================================================
# Network
# =============================================================================

# Only listen on localhost (container-internal communication)
bind 127.0.0.1

# Standard Redis port
port 6379

# Close connection after client is idle for N seconds (0 = disabled)
timeout 0

# TCP keepalive (detect dead connections)
tcp-keepalive 300

# =============================================================================
# Performance
# =============================================================================

# Number of databases (we only use 0)
databases 1

# Disable slow log (performance overhead)
slowlog-log-slower-than -1

# Limit client output buffer
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# =============================================================================
# Security
# =============================================================================

# No password by default (localhost only)
# Set via REDIS_PASSWORD environment variable if needed

# Disable dangerous commands in production
rename-command FLUSHALL ""
rename-command FLUSHDB ""
rename-command DEBUG ""

# =============================================================================
# Logging
# =============================================================================

# Log level (debug, verbose, notice, warning)
loglevel notice

# Log to stdout (container best practice)
logfile ""
